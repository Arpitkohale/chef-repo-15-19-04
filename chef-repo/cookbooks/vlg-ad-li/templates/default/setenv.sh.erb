#!/bin/sh
# Disted by Chef

LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$CATALINA_HOME/lib
export LD_LIBRARY_PATH

TZ="<%= @vlg_tomcat_timezone %>"
HOSTNAME=$(hostname -s)

CATALINA_OPTS="-Dcom.sun.management.jmxremote \
    -Dcom.sun.management.jmxremote.port=9004 \
    -Dcom.sun.management.jmxremote.ssl=false \
    -Dcom.sun.management.jmxremote.authenticate=false"

JAVA_OPTS="<%= @vlg_tomcat_java_opts %>"
JAVA_OPTS="$JAVA_OPTS -Djava.library.path=/lib:/lib64:/usr/lib:/usr/lib64:$JAVA_HOME/lib:<%= @vlg_tomcat_lib %>"
JAVA_OPTS="$JAVA_OPTS -Xms<%= @vlg_tomcat_jvm_heap %>"
JAVA_OPTS="$JAVA_OPTS -Xmx<%= @vlg_tomcat_jvm_heap %>"

JAVA_OPTS="$JAVA_OPTS -verbose:gc -XX:+PrintGC -XX:+PrintGCTimeStamps -XX:+PrintGCTimeStamps -XX:+PrintGCDetails -Xloggc:<%= @vlg_tomcat_jvm_gc_log %>"

JAVA_OPTS="$JAVA_OPTS -XX:+HeapDumpOnOutOfMemoryError"
JAVA_OPTS="$JAVA_OPTS -XX:-OmitStackTraceInFastThrow"

JAVA_OPTS="$JAVA_OPTS -DHOSTNAME=$HOSTNAME"

JAVA_OPTS="$JAVA_OPTS -Dspring.profiles.active=<%= node['vlg-ad-li']['env'] =%>"
JAVA_OPTS="$JAVA_OPTS -Dapplication.home=<%= node['vlg-base']['app_user_home'] =%>/AppHome"
